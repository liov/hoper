# Builder Image
FROM jybl/goprotoc AS compile

WORKDIR /work

ADD . /work

RUN go build -trimpath -o  /work/${output} /work/${sourceFile}

# Runtime Image
FROM frolvlad/alpine-glibc

#修改容器时区
ENV TZ=Asia/Shanghai LANG=C.UTF-8
COPY ./build/k8s/app/tz/localtime /etc/localtime
COPY ./build/k8s/app/tz/timezone /etc/timezone
RUN mkdir -p /usr/share/zoneinfo/Asia && ln -s /etc/localtime /usr/share/zoneinfo/Asia/Shanghai

WORKDIR /app

COPY --from=compile /work/${output} /app

CMD ["${cmd}"]
